<!DOCTYPE HTML>
<html>
<head>
    <title>Sorting Visualizer</title>
    <script src="//code.jquery.com/jquery-1.12.4.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/4.2.0/socket.io.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.js" integrity="sha512-+tu0+vUXyZX+S51npa//IN6znNTLZsBoy8mXn9WzHxfBqYMy6gOzzfTK0VqZf9O171RY9AJviHDokCnvEq8+1A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/javascript" charset="utf-8">
        insArr=[]
        selArr=[]
        heapArr=[]
        quickArr=[]
        radixArr=[]
        bubArr=[]
        mergeArr=[]
        bucketArr=[]

        step=0
        compare=0
        step1=0
        compare1=0

        $(document).ready(function() {

            namespace = '/sort';
            var socket = io(namespace);

            socket.on('connect', function() {
                socket.emit('my_event', {data: 'Connected'});
            });

            socket.on('ins', function(msg, cb) {
                insArr=msg.data.array
                step=msg.data.step
                compare=msg.data.compare
            });
            socket.on('sel', function(msg, cb) {
                selArr=msg.data.array
                step1=msg.data.step
                compare1=msg.data.compare
            });
            socket.on('quick', function(msg, cb) {
                quickArr=msg.data.array
            });
            socket.on('heap', function(msg, cb) {
                heapArr=msg.data.array
                console.log(heapArr)
            });
            socket.on('radix', function(msg, cb) {
                radixArr=msg.data.array
                console.log(radixArr)
            });
            socket.on('bub', function(msg, cb) {
                bubArr=msg.data.array
                console.log(bubArr)
            });
            socket.on('merge', function(msg, cb) {
                mergeArr=msg.data.array
                console.log(mergeArr)
            });
            socket.on('buck', function(msg, cb) {
                bucketArr=msg.data.array
                console.log(bucketArr)
            });

            $('form#controls').submit(function(event) {
                let min=parseInt($('#minim').val())
                let max=parseInt($('#maxim').val())

                data={
                    'speed':parseFloat($('#speedo').val()),
                    'min':min,
                    'max':max
                }
                socket.emit('insertion', {data: data});
                socket.emit('selection', {data: data});
                socket.emit('quick', {data: data});
                socket.emit('heap', {data: data});
                socket.emit('radix', {data:data});
                socket.emit('BubbleSort', {data:data});
                socket.emit('mergesort', {data:data});
                socket.emit('BucketSort', {data:data});
                return false;
            });
        });

        const width = 830, height = 830
        function setup(){
            createCanvas(width, height).parent("#main")
            insBuffer=createGraphics(200, 200)
            selBuffer=createGraphics(200, 200)
            quickBuffer=createGraphics(200, 200)
            heapBuffer=createGraphics(200, 200)
            radBuffer=createGraphics(200, 200)
            bubbleBuffer=createGraphics(200, 200)
            mergeBuffer=createGraphics(200, 200)
            bucketBuffer=createGraphics(200, 200)
            //to be implemented
            countBuffer=createGraphics(200, 200)
            
        }   
        
        function draw(){
            let lineWidth, noOfElements = insArr.length
            lineWidth = (200 / noOfElements)

            insBuffer.background(248, 237, 227)
            selBuffer.background(223, 211, 195)
            quickBuffer.background(248, 237, 227)
            heapBuffer.background(223, 211, 195)
            radBuffer.background(248, 237, 227)
            bubbleBuffer.background(223, 211, 195)
            mergeBuffer.background(223, 211, 195)
            bucketBuffer.background(223, 211, 195)
            //to be implemented
            countBuffer.background(223, 211, 195)
            
            
            let max=Math.max(...insArr)

            for(let i = 0; i < noOfElements; i++){
                insBuffer.textSize(15);
                insBuffer.textStyle(BOLD);
                insBuffer.text('Insertion Sort', 55, 20).fill(103, 71, 71)

                if (i===step)insBuffer.fill(255, 110, 131)
                else if(i==compare) insBuffer.fill(125, 110, 131)
                else insBuffer.fill(125, 110, 255)
                
                selBuffer.textSize(15);
                selBuffer.textStyle(BOLD);
                selBuffer.text('Selection Sort', 55, 20).fill(103, 71, 71)
                if (i===step1)selBuffer.fill(255, 110, 131)
                else if(i==compare1) selBuffer.fill(125, 110, 131)
                else selBuffer.fill(125, 110, 255)

                radBuffer.fill(125, 110, 131)
                quickBuffer.fill(125, 110, 131)
                heapBuffer.fill(125, 110, 131)
                bubbleBuffer.fill(125, 110, 131)
                mergeBuffer.fill(125, 110, 131)
                bucketBuffer.fill(125, 110, 131)

                insBuffer.rect((i*lineWidth),200, lineWidth, -(insArr[i]/max)*160)
                selBuffer.rect((i*lineWidth),200, lineWidth, -(selArr[i]/max)*160)
                quickBuffer.rect((i*lineWidth),200, lineWidth, -(quickArr[i]/max)*160)
                heapBuffer.rect((i*lineWidth),200, lineWidth, -(heapArr[i]/max)*160)
                radBuffer.rect((i*lineWidth), 200, lineWidth, -(radixArr[i]/max)*160)
                

                bubbleBuffer.textSize(15);
                bubbleBuffer.textStyle(BOLD);
                bubbleBuffer.text('Bubble Sort', 55, 20).fill(0, 255, 0)

                if (i%2==0)bubbleBuffer.fill(0, 0, 0)
                else bubbleBuffer.fill(210, 4, 45)

                bubbleBuffer.rect((i*lineWidth), 200, lineWidth, -(bubArr[i]/max)*160)

                mergeBuffer.textSize(15);
                mergeBuffer.textStyle(BOLD);
                mergeBuffer.text('Merge Sort', 55, 20).fill(0, 255, 0)

                if (i%2==0)mergeBuffer.fill(21, 21, 21)
                else mergeBuffer.fill(255, 255, 0)
                
                mergeBuffer.rect((i*lineWidth), 200, lineWidth, -(mergeArr[i]/max)*160)
                
                bucketBuffer.textSize(15)
                bucketBuffer.textStyle(BOLD)
                bucketBuffer.text('Bucket Sort', 55, 20).fill(103, 71, 71)
                
                if (i%2 == 0)bucketBuffer.fill(0, 0, 0)
                else bucketBuffer.fill(0, 255, 0)
                bucketBuffer.rect((i*lineWidth), 200, lineWidth, -(bucketArr[i]/max)*160)
            }

            image(insBuffer, 0, 0)
            image(selBuffer, 210, 0)
            image(quickBuffer, 210, 210)
            image(heapBuffer, 0, 210)
            image(radBuffer, 420, 0)
            image(bubbleBuffer, 210, 420)
            image(mergeBuffer, 0, 420)
            image(bucketBuffer, 420, 420)
            //to be implemented
            image(countBuffer, 420, 210)
            
            

        }
    </script>
</head>
<body style="background-color:#7D6E83; ">
    <div id="main">
        <form id="controls" method="POST" action='#'>
            <input type="number" id="minim" placeholder="Minimum">
            <input type="number" id="maxim" placeholder="Maximum">
            <input type="text" id="speedo" placeholder="Delay (s)">
            <input type="submit" value="Start">
        </form>
    </div>
</body>
</html>